---
title: "Relatório Assessoria 1"
output: html_document
date: "2024-04-07"
---

```{r, include=FALSE}
pacman::p_load(readxl,dplyr,knitr,rmarkdown)

base <- read_excel('C:/Users/amand/OneDrive/Documentos/GitHub/laboratorio1/Respostas.xlsx')
base <- base[, -ncol(base)]
name_columns <- c(
  "genero",
  "genero_outro",
  "idade",
  "estado_civil",
  "outro_estado_civil",
  "filhos",
  "qtd_filhos",
  "idade_filhos",
  "mora_com",
  "outro_mora_com",
  "escolaridade",
  "curso_formacao",
  "categoria",
  "cargo",
  "cargo_nivel1",
  "cargo_nivel2",
  "carga_horaria_semanal",
  "outro_carga_horaria_semanal",
  "unidade_lotacao",
  "cd_ou_fg",
  "campus",
  "ano_ingresso",
  "ingresso_cotas_pcd",
  "sentimento_local_trabalho",
  "deficiencia",
  "deficiencia_outro",
  "periodo_diagnostico",
  "causa_deficiencia",
  "uso_tecnologia_assistiva_recurso",
  "qual_tecnologia",
  "tecnologia_disponibilizada_ufsm",
  "como_consegue_obter_tecnologia",
  "necessita_acompanhamento/apoio_atividades_cotidianas_notrabalho",
  "se_sim_quais_atividades?",
  "acompanhamento/apoio_disponibilizado_ufsm",
  "se_nao_como_consegue_obter",
  "como_considera_acessibilidade_arquitetonica_ufsm",
  "como_considera_acessibilidade_atitudinal_ufsm",
  "como_considera_acessibilidade_instrumental/digital_ufsm",
  "como_considera_acessibilidade_comunicacional_ufsm",
  "conhece_legislacao_br_sobre_acessibilidade",
  "objetivo_quando_fez_concurso_ufsm",
  "outro_objetivo_quando_fez_concurso_ufsm",
  "dificuldade_adaptacao_durante_ingresso_atividades_laborais_ufsm",
  "dificuldade_adaptacao_se_sim_como_foi_resolvido",
  "enfrentou_problema_relacionamento_chefia_eou_colegas",
  "problema_relacionamento_se_sim_como_foi_resolvido",
  "ja_foi_parte_reclamante_processo_administrativo_disciplinar_sindicancia_eou_reclamatoria_trabalhista_naufsm",
  "considera_ufsm_dispoe_recursos_humanos_materiais_suficientes_atender_necessidades_que_eventualmente_surjam_em_relacao_acessibilidade",
  "se_nao_relate_oq_considera_insuficiente",
  "voce_participa_associacao/sindicato/outros_grupos_luta_direitos_trabalhistas",
  "se_sim_qual_associacao/sindicato",
  "se_participa_sente_pautas_pcd_consideradas_em_acoes_da_associacao/sindicato",
  "espaco_comentarios")

# curso formacao tirei pq há 62 categorias distintas
# cargo tirei pq não tem padrão na escrita (42 categorias distintas)
# unidade_lotacao variável inútil para gente e 56 categorias distintas
# ia tratar a variável mora_com e outro_mora_com mas são categorias demais e estão confusas
# gênero_outro só tem nulo

# Remoção colunas
colnames(base) <- name_columns
base1 <- base[, !colnames(base) %in% c("idade_filhos", "cargo_nivel1", "cargo_nivel2",
                                       "se_nao_como_consegue_obter","curso_formacao","cargo",
                                       "unidade_lotacao","mora_com","outro_mora_com","gênero_outro")]

```
## Relatório Estatístico - Projeto de Pesquisa: Relações de Trabalho e os servidores com deficiência na Universidade Federal de Santa Maria (UFSM)

### Introdução

O presente relatório apresenta uma análise de dados descritiva e exploratória relativa aos dados obtidos via formulário referente ao projeto de pesquisa Relações de Trabalho e os servidores com deficiência na Universidade Federal de Santa Maria (UFSM). O objetivo geral é entender qual o significado do trabalho para os servidores com deficiência na Universidade Federal de Santa Maria (UFSM) e como o capacitismo interfere nas relações laborais desses servidores. Para concretizar o objetivo geral, o presente estudo almeja realizar os seguintes objetivos específicos:

* Mapear os servidores com deficiência na UFSM;
* Compreender como se dão suas relações de trabalho na organização e se essas são ou já foram permeadas pelo capacitismo;
* Entender qual o significado do trabalho para os servidores com deficiência na UFSM;
* Propor alternativas e indicadores para que a área de gestão de pessoas possa facilitar a inclusão de servidores com deficiência nas relações de trabalho.


### Base de dados

Na tabela abaixo temos os dados sem nenhum tratamento. São 54 variáveis, referentes ás 54 perguntas contidas no formulário preenchido pelos servidores (a última pergunta referente ao e-mail foi removida da tabela):

```{r, echo=FALSE}
library(knitr)
paged_table(base)
```

Na tabela abaixo vemos como a base ficou depois de alguns tratamentos e remoção de algumas variáveis que não usaremos:  

```{r, include=FALSE}
# Tratamento carga horaria semanal
base1 <- mutate(base1, carga_horaria_semanal = ifelse(carga_horaria_semanal == 'Outra', outro_carga_horaria_semanal, carga_horaria_semanal))
base1$carga_horaria_semanal <- gsub("\\D", "", base1$carga_horaria_semanal)
base1 <- base1[, !colnames(base1) %in% c("outro_carga_horaria_semanal")]

# Tratamento estado civil
base1 <- mutate(base1, estado_civil = ifelse(estado_civil == 'Outro', 'Divorciado(a)', estado_civil))
base1 <- base1[, !colnames(base1) %in% c("outro_estado_civil")]

# Tratamento qtd filhos
base1 <- mutate(base1, qtd_filhos = ifelse(is.na(qtd_filhos), "0", qtd_filhos))

# tratamento tipo das variaveis
base1$genero <- as.factor(base1$genero)
```

```{r, echo=FALSE}
library(knitr)
paged_table(base1)
```

### Análise Descritiva
#### Gênero x Grau de satisfação para questões de acessibilidade
Na nossa base de dados temos o mesmo número de pessoas no sexo feminino e masculino.
```{r, include=FALSE}
# Genero x grau de satisfacao
# acessibilidade arquitetonica
table(base1$genero,base1$como_considera_acessibilidade_arquitetonica_ufsm)
table(base1$genero)
prop.table(table(base1$genero,base1$como_considera_acessibilidade_arquitetonica_ufsm))*100
```

```{r, echo=FALSE,warning=FALSE}
x <- xtabs(~genero + como_considera_acessibilidade_arquitetonica_ufsm, data = base1)
x <- x[, c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")]
cols <- c("#445a14", "#778c43")

barplot(x,
        beside = TRUE,
        xlab = "Como considera a acessibilidade arquitetônica na UFSM?",
        ylab = "Frequência absoluta",
        col = cols)
legend("topright",
       legend = levels(base1$genero),
       fill = cols,
       bty = "n")
box(bty = "L")
title(main = "Avaliação da Acessibilidade Arquitetônica na UFSM por Gênero", font.main = 3)
```