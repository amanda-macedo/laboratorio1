---
title: "Relatório Assessoria 1"
output: html_document
date: "2024-04-07"
---

```{r, include=FALSE}
pacman::p_load(gridExtra,readxl,dplyr,knitr,rmarkdown,ggplot2)

base <- read_excel('C:/Users/amand/OneDrive/Documentos/GitHub/laboratorio1/Respostas.xlsx')
base <- base[, -ncol(base)]
name_columns <- c(
  "genero",
  "genero_outro",
  "idade",
  "estado_civil",
  "outro_estado_civil",
  "filhos",
  "qtd_filhos",
  "idade_filhos",
  "mora_com",
  "outro_mora_com",
  "escolaridade",
  "curso_formacao",
  "categoria",
  "cargo",
  "cargo_nivel1",
  "cargo_nivel2",
  "carga_horaria_semanal",
  "outro_carga_horaria_semanal",
  "unidade_lotacao",
  "cd_ou_fg",
  "campus",
  "ano_ingresso",
  "ingresso_cotas_pcd",
  "sentimento_local_trabalho",
  "deficiencia",
  "deficiencia_outro",
  "periodo_diagnostico",
  "causa_deficiencia",
  "uso_tecnologia_assistiva_recurso",
  "qual_tecnologia",
  "tecnologia_disponibilizada_ufsm",
  "como_consegue_obter_tecnologia",
  "necessita_acompanhamento/apoio_atividades_cotidianas_notrabalho",
  "se_sim_quais_atividades?",
  "acompanhamento/apoio_disponibilizado_ufsm",
  "se_nao_como_consegue_obter",
  "como_considera_acessibilidade_arquitetonica_ufsm",
  "como_considera_acessibilidade_atitudinal_ufsm",
  "como_considera_acessibilidade_instrumental_digital_ufsm",
  "como_considera_acessibilidade_comunicacional_ufsm",
  "conhece_legislacao_br_sobre_acessibilidade",
  "objetivo_quando_fez_concurso_ufsm",
  "outro_objetivo_quando_fez_concurso_ufsm",
  "dificuldade_adaptacao_durante_ingresso_atividades_laborais_ufsm",
  "dificuldade_adaptacao_se_sim_como_foi_resolvido",
  "enfrentou_problema_relacionamento_chefia_eou_colegas",
  "problema_relacionamento_se_sim_como_foi_resolvido",
  "ja_foi_parte_reclamante_processo_administrativo_disciplinar_sindicancia_eou_reclamatoria_trabalhista_naufsm",
  "considera_ufsm_dispoe_recursos_humanos_materiais_suficientes_atender_necessidades_que_eventualmente_surjam_em_relacao_acessibilidade",
  "se_nao_relate_oq_considera_insuficiente",
  "voce_participa_associacao/sindicato/outros_grupos_luta_direitos_trabalhistas",
  "se_sim_qual_associacao/sindicato",
  "se_participa_sente_pautas_pcd_consideradas_em_acoes_da_associacao/sindicato",
  "espaco_comentarios")

# curso formacao tirei pq há 62 categorias distintas
# cargo tirei pq não tem padrão na escrita (42 categorias distintas)
# unidade_lotacao variável inútil para gente e 56 categorias distintas
# ia tratar a variável mora_com e outro_mora_com mas são categorias demais e estão confusas
# gênero_outro só tem nulo

# Remoção colunas
colnames(base) <- name_columns
base1 <- base[, !colnames(base) %in% c("idade_filhos", "cargo_nivel1", "cargo_nivel2",
                                       "se_nao_como_consegue_obter","curso_formacao","cargo",
                                       "unidade_lotacao","mora_com","outro_mora_com","gênero_outro")]

```

## Relatório Estatístico - Projeto de Pesquisa: Relações de Trabalho e os servidores com deficiência na Universidade Federal de Santa Maria (UFSM)

### Introdução

O presente relatório apresenta uma análise de dados descritiva e exploratória relativa aos dados obtidos via formulário referente ao projeto de pesquisa Relações de Trabalho e os servidores com deficiência na Universidade Federal de Santa Maria (UFSM). O objetivo geral é entender qual o significado do trabalho para os servidores com deficiência na Universidade Federal de Santa Maria (UFSM) e como o capacitismo interfere nas relações laborais desses servidores. Para concretizar o objetivo geral, o presente estudo almeja realizar os seguintes objetivos específicos:

-   Mapear os servidores com deficiência na UFSM;
-   Compreender como se dão suas relações de trabalho na organização e se essas são ou já foram permeadas pelo capacitismo;
-   Entender qual o significado do trabalho para os servidores com deficiência na UFSM;
-   Propor alternativas e indicadores para que a área de gestão de pessoas possa facilitar a inclusão de servidores com deficiência nas relações de trabalho.

### Base de dados

Na tabela abaixo temos os dados sem nenhum tratamento. São 54 variáveis, referentes ás 54 perguntas contidas no formulário preenchido pelos servidores (a última pergunta referente ao e-mail foi removida da tabela):

```{r, echo=FALSE}
library(knitr)
paged_table(base)
```

Na tabela abaixo vemos como a base ficou depois de alguns tratamentos e remoção de algumas variáveis que não usaremos:

```{r, include=FALSE}
# Tratamento carga horaria semanal
base1 <- mutate(base1, carga_horaria_semanal = ifelse(carga_horaria_semanal == 'Outra', outro_carga_horaria_semanal, carga_horaria_semanal))
base1$carga_horaria_semanal <- gsub("\\D", "", base1$carga_horaria_semanal)
base1 <- base1[, !colnames(base1) %in% c("outro_carga_horaria_semanal")]

# Tratamento estado civil
base1 <- mutate(base1, estado_civil = ifelse(estado_civil == 'Outro', 'Divorciado(a)', estado_civil))
base1 <- base1[, !colnames(base1) %in% c("outro_estado_civil")]

# Tratamento qtd filhos
base1 <- mutate(base1, qtd_filhos = ifelse(is.na(qtd_filhos), "0", qtd_filhos))

# tratamento tipo das variaveis
base1$genero <- as.factor(base1$genero)
```

```{r, echo=FALSE}
library(knitr)
paged_table(base1)
```

### Análise Descritiva

#### Gênero x Grau de satisfação para questões de acessibilidade

Na nossa base de dados temos o mesmo número de pessoas no sexo feminino e masculino, ambos com 32 pessoas. Abaixo temos o gráfico de barras que mostra a quantidade de respostas em cada nível para cada gênero para questões de opinião em relação à acessibilidade.

```{r, include=FALSE}
# Genero x grau de satisfacao
# acessibilidade arquitetonica
table(base1$genero,base1$como_considera_acessibilidade_arquitetonica_ufsm)
table(base1$genero)
prop.table(table(base1$genero,base1$como_considera_acessibilidade_arquitetonica_ufsm))*100

base_feminino <- base1[base1$genero == "Feminino", ]
base_feminino$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_feminino$como_considera_acessibilidade_arquitetonica_ufsm, levels = names(sort(table(base_feminino$como_considera_acessibilidade_arquitetonica_ufsm), decreasing = TRUE)))

base_masculino <- base1[base1$genero == "Masculino", ]
base_masculino$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_masculino$como_considera_acessibilidade_arquitetonica_ufsm, levels = names(sort(table(base_masculino$como_considera_acessibilidade_arquitetonica_ufsm), decreasing = TRUE)))

# Pra aparecer no grafico na ordem
ordem <- c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")

base_feminino$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_feminino$como_considera_acessibilidade_arquitetonica_ufsm, levels = ordem)
base_masculino$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_masculino$como_considera_acessibilidade_arquitetonica_ufsm, levels = ordem)
base1$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base1$como_considera_acessibilidade_arquitetonica_ufsm, levels = ordem)

print(sprintf('Percentual de respostas bom ou regular para os homens é de %.1f %% e para mulheres é de %.1f %%', 
               sum(base_masculino$como_considera_acessibilidade_arquitetonica_ufsm %in% c("Bom", "Ótimo")) / nrow(base_masculino) * 100, 
               sum(base_feminino$como_considera_acessibilidade_arquitetonica_ufsm %in% c("Bom", "Ótimo")) / nrow(base_feminino) * 100))
```

Em relação acessibilidade arquitetônica da UFSM (Exemplos: rampas, elevadores e banheiros adaptados, calçadas com piso tátil, vagas reservadas em estacionamentos, etc), os homens parecem estar mais satisfeitos do que as mulheres, em geral. Cerca de 37,5% das mulheres responderam bom ou ótimo e, para os homens, este percentual fica em 46,9%.  

```{r, echo=FALSE,warning=FALSE,warning=FALSE,fig.height=6, fig.width=10}
texto_size <- 2.5 #  tamanho do texto para as frequências
titulo_size <- 10 # tamanho do título dos gráficos

grafico <- ggplot(base1, aes(x = como_considera_acessibilidade_arquitetonica_ufsm, fill = genero)) +
  geom_bar(position = "dodge") +
  labs(x = "Acessibilidade Arquitetônica na UFSM", y = "Frequência absoluta", fill = "Gênero") +
  ggtitle("Avaliação da Acessibilidade Arquitetônica por Gênero") +
  scale_fill_manual(values = c("Feminino" = "#445a14", "Masculino" = "#778c43")) +
  theme_minimal() +
  theme(plot.title = element_text(size = titulo_size))

grafico2 <- ggplot(base_feminino, aes(x = como_considera_acessibilidade_arquitetonica_ufsm)) +
  geom_bar(fill = "#445a14", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Feminino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grafico3 <- ggplot(base_masculino, aes(x = como_considera_acessibilidade_arquitetonica_ufsm)) +
  geom_bar(fill = "#778c43", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Masculino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grid.arrange(arrangeGrob(grafico2, grafico3, ncol = 1),
             grafico,
             layout_matrix = matrix(c(1, 2), ncol = 2, byrow = FALSE),
             widths = c(1, 2))
```



```{r, include=FALSE}
# instrumental/digital
table(base1$genero,base1$como_considera_acessibilidade_instrumental_digital_ufsm)
prop.table(table(base1$genero,base1$como_considera_acessibilidade_instrumental_digital_ufsm))*100

base_feminino <- base1[base1$genero == "Feminino", ]
base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm, levels = names(sort(table(base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm), decreasing = TRUE)))

base_masculino <- base1[base1$genero == "Masculino", ]
base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm, levels = names(sort(table(base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm), decreasing = TRUE)))

# Pra aparecer no grafico na ordem
ordem <- c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")

base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm, levels = ordem)
base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm, levels = ordem)
base1$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base1$como_considera_acessibilidade_instrumental_digital_ufsm, levels = ordem)

print(sprintf('Percentual de respostas bom ou regular para os homens é de %.1f %% e para mulheres é de %.1f %%', 
               sum(base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm %in% c("Bom", "Ótimo")) / nrow(base_masculino) * 100, 
               sum(base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm %in% c("Bom", "Ótimo")) / nrow(base_feminino) * 100))
```

Em relação acessibilidade instrumental/digital da UFSM (Ex: software de leitor de tela no computador, sites e aplicativos institucionais acessíveis e ferramentas que eliminem barreiras digitais e de instrumentos de trabalho), os homens também parecem estar mais satisfeitos do que as mulheres, em geral. Cerca de 37,5% das mulheres responderam bom ou ótimo e, para os homens, este percentual fica em 50%.  

```{r, echo=FALSE,warning=FALSE,warning=FALSE,fig.height=6, fig.width=10}
texto_size <- 2.5 #  tamanho do texto para as frequências
titulo_size <- 10 # tamanho do título dos gráficos

grafico <- ggplot(base1, aes(x = como_considera_acessibilidade_instrumental_digital_ufsm, fill = genero)) +
  geom_bar(position = "dodge") +
  labs(x = "Acessibilidade Instrumental/Digital na UFSM", y = "Frequência absoluta", fill = "Gênero") +
  ggtitle("Avaliação da Acessibilidade Instrumental/Digital por Gênero") +
  scale_fill_manual(values = c("Feminino" = "#445a14", "Masculino" = "#778c43")) +
  theme_minimal() +
  theme(plot.title = element_text(size = titulo_size))

grafico2 <- ggplot(base_feminino, aes(x = como_considera_acessibilidade_instrumental_digital_ufsm)) +
  geom_bar(fill = "#445a14", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Feminino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grafico3 <- ggplot(base_masculino, aes(x = como_considera_acessibilidade_instrumental_digital_ufsm)) +
  geom_bar(fill = "#778c43", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Masculino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grid.arrange(arrangeGrob(grafico2, grafico3, ncol = 1),
             grafico,
             layout_matrix = matrix(c(1, 2), ncol = 2, byrow = FALSE),
             widths = c(1, 2))
```




```{r, include=FALSE}
# instrumental/digital
table(base1$genero,base1$como_considera_acessibilidade_atitudinal_ufsm)
prop.table(table(base1$genero,base1$como_considera_acessibilidade_atitudinal_ufsm))*100

base_feminino <- base1[base1$genero == "Feminino", ]
base_feminino$como_considera_acessibilidade_atitudinal_ufsm <- factor(base_feminino$como_considera_acessibilidade_atitudinal_ufsm, levels = names(sort(table(base_feminino$como_considera_acessibilidade_atitudinal_ufsm), decreasing = TRUE)))

base_masculino <- base1[base1$genero == "Masculino", ]
base_masculino$como_considera_acessibilidade_atitudinal_ufsm <- factor(base_masculino$como_considera_acessibilidade_atitudinal_ufsm, levels = names(sort(table(base_masculino$como_considera_acessibilidade_atitudinal_ufsm), decreasing = TRUE)))

# Pra aparecer no grafico na ordem
ordem <- c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")

base_feminino$como_considera_acessibilidade_atitudinal_ufsm <- factor(base_feminino$como_considera_acessibilidade_atitudinal_ufsm, levels = ordem)
base_masculino$como_considera_acessibilidade_atitudinal_ufsm <- factor(base_masculino$como_considera_acessibilidade_atitudinal_ufsm, levels = ordem)
base1$como_considera_acessibilidade_atitudinal_ufsm <- factor(base1$como_considera_acessibilidade_atitudinal_ufsm, levels = ordem)

print(sprintf('Percentual de respostas bom ou regular para os homens é de %.1f %% e para mulheres é de %.1f %%', 
               sum(base_masculino$como_considera_acessibilidade_atitudinal_ufsm %in% c("Bom", "Ótimo")) / nrow(base_masculino) * 100, 
               sum(base_feminino$como_considera_acessibilidade_atitudinal_ufsm %in% c("Bom", "Ótimo")) / nrow(base_feminino) * 100))
```

Em relação acessibilidade atitudinal da UFSM (incentivo a percepções sem preconceitos, discriminações e estigmas), os homens novamnete se mostram mais satisfeitos do que as mulheres, em geral. Cerca de 43,8% das mulheres responderam bom ou ótimo e, para os homens, este percentual fica em 59,4%.  

```{r, echo=FALSE,warning=FALSE,warning=FALSE,fig.height=6, fig.width=10}
texto_size <- 2.5 #  tamanho do texto para as frequências
titulo_size <- 10 # tamanho do título dos gráficos

grafico <- ggplot(base1, aes(x = como_considera_acessibilidade_atitudinal_ufsm, fill = genero)) +
  geom_bar(position = "dodge") +
  labs(x = "Acessibilidade Atitudinal na UFSM", y = "Frequência absoluta", fill = "Gênero") +
  ggtitle("Avaliação da Acessibilidade Atitudinal por Gênero") +
  scale_fill_manual(values = c("Feminino" = "#445a14", "Masculino" = "#778c43")) +
  theme_minimal() +
  theme(plot.title = element_text(size = titulo_size))

grafico2 <- ggplot(base_feminino, aes(x = como_considera_acessibilidade_atitudinal_ufsm)) +
  geom_bar(fill = "#445a14", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Feminino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grafico3 <- ggplot(base_masculino, aes(x = como_considera_acessibilidade_atitudinal_ufsm)) +
  geom_bar(fill = "#778c43", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Masculino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grid.arrange(arrangeGrob(grafico2, grafico3, ncol = 1),
             grafico,
             layout_matrix = matrix(c(1, 2), ncol = 2, byrow = FALSE),
             widths = c(1, 2))
```



```{r, include=FALSE}
# comunicacional
table(base1$genero,base1$como_considera_acessibilidade_comunicacional_ufsm)
prop.table(table(base1$genero,base1$como_considera_acessibilidade_comunicacional_ufsm))*100

base_feminino <- base1[base1$genero == "Feminino", ]
base_feminino$como_considera_acessibilidade_comunicacional_ufsm <- factor(base_feminino$como_considera_acessibilidade_comunicacional_ufsm, levels = names(sort(table(base_feminino$como_considera_acessibilidade_comunicacional_ufsm), decreasing = TRUE)))

base_masculino <- base1[base1$genero == "Masculino", ]
base_masculino$como_considera_acessibilidade_comunicacional_ufsm <- factor(base_masculino$como_considera_acessibilidade_comunicacional_ufsm, levels = names(sort(table(base_masculino$como_considera_acessibilidade_comunicacional_ufsm), decreasing = TRUE)))

# Pra aparecer no grafico na ordem
ordem <- c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")

base_feminino$como_considera_acessibilidade_comunicacional_ufsm <- factor(base_feminino$como_considera_acessibilidade_comunicacional_ufsm, levels = ordem)
base_masculino$como_considera_acessibilidade_comunicacional_ufsm <- factor(base_masculino$como_considera_acessibilidade_comunicacional_ufsm, levels = ordem)
base1$como_considera_acessibilidade_comunicacional_ufsm <- factor(base1$como_considera_acessibilidade_comunicacional_ufsm, levels = ordem)

print(sprintf('Percentual de respostas bom ou regular para os homens é de %.1f %% e para mulheres é de %.1f %%',
               sum(base_masculino$como_considera_acessibilidade_comunicacional_ufsm %in% c("Bom", "Ótimo")) / nrow(base_masculino) * 100, 
               sum(base_feminino$como_considera_acessibilidade_comunicacional_ufsm %in% c("Bom", "Ótimo")) / nrow(base_feminino) * 100))
```

Em relação acessibilidade comunicacional da UFSM (oferecimento de recursos e atividades que promovam a independência no acesso a qualquer conteúdo. Isso inclui legendas, áudios, descrições, Libras, braile, etc), os homens novamnete se mostram mais satisfeitos do que as mulheres, em geral. Cerca de 28,1% das mulheres responderam bom ou ótimo e, para os homens, este percentual fica em 56,2%.  

```{r, echo=FALSE,warning=FALSE,warning=FALSE,fig.height=6, fig.width=10}
texto_size <- 2.5 #  tamanho do texto para as frequências
titulo_size <- 10 # tamanho do título dos gráficos

grafico <- ggplot(base1, aes(x = como_considera_acessibilidade_comunicacional_ufsm, fill = genero)) +
  geom_bar(position = "dodge") +
  labs(x = "Acessibilidade Comunicacional na UFSM", y = "Frequência absoluta", fill = "Gênero") +
  ggtitle("Avaliação da Acessibilidade Comunicacional por Gênero") +
  scale_fill_manual(values = c("Feminino" = "#445a14", "Masculino" = "#778c43")) +
  theme_minimal() +
  theme(plot.title = element_text(size = titulo_size))

grafico2 <- ggplot(base_feminino, aes(x = como_considera_acessibilidade_comunicacional_ufsm)) +
  geom_bar(fill = "#445a14", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Feminino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grafico3 <- ggplot(base_masculino, aes(x = como_considera_acessibilidade_comunicacional_ufsm)) +
  geom_bar(fill = "#778c43", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Masculino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grid.arrange(arrangeGrob(grafico2, grafico3, ncol = 1),
             grafico,
             layout_matrix = matrix(c(1, 2), ncol = 2, byrow = FALSE),
             widths = c(1, 2))
```

Abaixo a tabela mostra a visão geral de como cada gênero enxerga as questões de acessibilidade. Para as mulheres ..........

```{r, echo=FALSE,warning=FALSE,warning=FALSE}
questoes <- c("como_considera_acessibilidade_comunicacional_ufsm",
              "como_considera_acessibilidade_atitudinal_ufsm",
              "como_considera_acessibilidade_instrumental_digital_ufsm",
              "como_considera_acessibilidade_arquitetonica_ufsm")
niveis <- c("otimo", "bom", "regular", "ruim", "pessimo")

acessibilidade_geral_fem <- bind_rows(lapply(questoes, function(questao) {
  prop_table <- table(base1[base1$genero == "Feminino", ][[questao]])
  prop.table(prop_table) * 100
}), .id = "Questão")

acessibilidade_geral_fem$Questão <- c('Comunicacional','Atitudinal','Instrumental/Digital','Arquitetônica')
acessibilidade_geral_fem <- acessibilidade_geral_fem %>%  rename('Ótimo (%)' = Ótimo, 'Bom (%)' = Bom, 'Regular (%)' = Regular, 'Ruim (%)' = Ruim,'Péssimo (%)' = Péssimo)

acessibilidade_geral_masc <- bind_rows(lapply(questoes, function(questao) {
  prop_table <- table(base1[base1$genero == "Masculino", ][[questao]])
  prop.table(prop_table) * 100
}), .id = "Questão")

acessibilidade_geral_masc$Questão <- c('Comunicacional','Atitudinal','Instrumental/Digital','Arquitetônica')
acessibilidade_geral_masc <- acessibilidade_geral_masc %>%  rename('Ótimo (%)' = Ótimo, 'Bom (%)' = Bom, 'Regular (%)' = Regular, 'Ruim (%)' = Ruim,'Péssimo (%)' = Péssimo)

knitr::kable(acessibilidade_geral_masc)
knitr::kable(acessibilidade_geral_fem)
```
#### Campi x Grau de satisfação para questões de acessibilidade

Na nossa base de dados temos 59 pessoas do campus de Santa Maria, 3 de Cachoeira do Sul, 1 de Frederico Westphalene 1 de Palmeira das Missões. Abaixo temos o gráfico de barras que mostra a quantidade de respostas em cada nível para cada campus para questões de opinião em relação à acessibilidade.  

```{r, include=FALSE}
# campus x grau de satisfacao
# acessibilidade arquitetonica
table(base1$campus,base1$como_considera_acessibilidade_arquitetonica_ufsm)
table(base1$campus)
prop.table(table(base1$campus,base1$como_considera_acessibilidade_arquitetonica_ufsm))*100

base_cachoeira <- base1[base1$campus == "Cachoeira do Sul", ]
base_cachoeira$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_cachoeira$como_considera_acessibilidade_arquitetonica_ufsm, levels = names(sort(table(base_cachoeira$como_considera_acessibilidade_arquitetonica_ufsm), decreasing = TRUE)))

base_frederico <- base1[base1$campus == "Frederico Westphalen", ]
base_frederico$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_frederico$como_considera_acessibilidade_arquitetonica_ufsm, levels = names(sort(table(base_frederico$como_considera_acessibilidade_arquitetonica_ufsm), decreasing = TRUE)))

base_palmeira <- base1[base1$campus == "Palmeira das Missões", ]
base_palmeira$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_palmeira$como_considera_acessibilidade_arquitetonica_ufsm, levels = names(sort(table(base_palmeira$como_considera_acessibilidade_arquitetonica_ufsm), decreasing = TRUE)))

base_santa <- base1[base1$campus == "Santa Maria", ]
base_santa$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_santa$como_considera_acessibilidade_arquitetonica_ufsm, levels = names(sort(table(base_santa$como_considera_acessibilidade_arquitetonica_ufsm), decreasing = TRUE)))

# Pra aparecer no grafico na ordem
ordem <- c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")

base_cachoeira$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_cachoeira$como_considera_acessibilidade_arquitetonica_ufsm, levels = ordem)

base_frederico$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_frederico$como_considera_acessibilidade_arquitetonica_ufsm, levels = ordem)

base_palmeira$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_palmeira$como_considera_acessibilidade_arquitetonica_ufsm, levels = ordem)

base_santa$como_considera_acessibilidade_arquitetonica_ufsm <- factor(base_santa$como_considera_acessibilidade_arquitetonica_ufsm, levels = ordem)

```

Em relação acessibilidade arquitetônica da UFSM (Exemplos: rampas, elevadores e banheiros adaptados, calçadas com piso tátil, vagas reservadas em estacionamentos, etc), XXX

```{r, echo=FALSE,warning=FALSE,warning=FALSE,fig.height=6, fig.width=10}
texto_size <- 2.5 #  tamanho do texto para as frequências
titulo_size <- 10 # tamanho do título dos gráficos

ggplot(base1, aes(x = como_considera_acessibilidade_arquitetonica_ufsm, fill = campus)) +
  geom_bar(position = "dodge") +
  labs(x = "Acessibilidade Arquitetônica na UFSM", y = "Frequência absoluta", fill = "Campus") +
  ggtitle("Avaliação da Acessibilidade Arquitetônica por Campus") +
  #scale_fill_manual(values = c("Feminino" = "#445a14", "Masculino" = "#778c43")) +
  theme_minimal() +
  theme(plot.title = element_text(size = titulo_size))

```



```{r, include=FALSE}
# instrumental/digital
table(base1$genero,base1$como_considera_acessibilidade_instrumental_digital_ufsm)
prop.table(table(base1$genero,base1$como_considera_acessibilidade_instrumental_digital_ufsm))*100

base_feminino <- base1[base1$genero == "Feminino", ]
base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm, levels = names(sort(table(base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm), decreasing = TRUE)))

base_masculino <- base1[base1$genero == "Masculino", ]
base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm, levels = names(sort(table(base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm), decreasing = TRUE)))

# Pra aparecer no grafico na ordem
ordem <- c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")

base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm, levels = ordem)
base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm, levels = ordem)
base1$como_considera_acessibilidade_instrumental_digital_ufsm <- factor(base1$como_considera_acessibilidade_instrumental_digital_ufsm, levels = ordem)

print(sprintf('Percentual de respostas bom ou regular para os homens é de %.1f %% e para mulheres é de %.1f %%', 
               sum(base_masculino$como_considera_acessibilidade_instrumental_digital_ufsm %in% c("Bom", "Ótimo")) / nrow(base_masculino) * 100, 
               sum(base_feminino$como_considera_acessibilidade_instrumental_digital_ufsm %in% c("Bom", "Ótimo")) / nrow(base_feminino) * 100))
```

Em relação acessibilidade instrumental/digital da UFSM (Ex: software de leitor de tela no computador, sites e aplicativos institucionais acessíveis e ferramentas que eliminem barreiras digitais e de instrumentos de trabalho), os homens também parecem estar mais satisfeitos do que as mulheres, em geral. Cerca de 37,5% das mulheres responderam bom ou ótimo e, para os homens, este percentual fica em 50%.  

```{r, echo=FALSE,warning=FALSE,warning=FALSE,fig.height=6, fig.width=10}
texto_size <- 2.5 #  tamanho do texto para as frequências
titulo_size <- 10 # tamanho do título dos gráficos

grafico <- ggplot(base1, aes(x = como_considera_acessibilidade_instrumental_digital_ufsm, fill = genero)) +
  geom_bar(position = "dodge") +
  labs(x = "Acessibilidade Instrumental/Digital na UFSM", y = "Frequência absoluta", fill = "Gênero") +
  ggtitle("Avaliação da Acessibilidade Instrumental/Digital por Gênero") +
  scale_fill_manual(values = c("Feminino" = "#445a14", "Masculino" = "#778c43")) +
  theme_minimal() +
  theme(plot.title = element_text(size = titulo_size))

grafico2 <- ggplot(base_feminino, aes(x = como_considera_acessibilidade_instrumental_digital_ufsm)) +
  geom_bar(fill = "#445a14", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Feminino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grafico3 <- ggplot(base_masculino, aes(x = como_considera_acessibilidade_instrumental_digital_ufsm)) +
  geom_bar(fill = "#778c43", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Masculino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grid.arrange(arrangeGrob(grafico2, grafico3, ncol = 1),
             grafico,
             layout_matrix = matrix(c(1, 2), ncol = 2, byrow = FALSE),
             widths = c(1, 2))
```




```{r, include=FALSE}
# instrumental/digital
table(base1$genero,base1$como_considera_acessibilidade_atitudinal_ufsm)
prop.table(table(base1$genero,base1$como_considera_acessibilidade_atitudinal_ufsm))*100

base_feminino <- base1[base1$genero == "Feminino", ]
base_feminino$como_considera_acessibilidade_atitudinal_ufsm <- factor(base_feminino$como_considera_acessibilidade_atitudinal_ufsm, levels = names(sort(table(base_feminino$como_considera_acessibilidade_atitudinal_ufsm), decreasing = TRUE)))

base_masculino <- base1[base1$genero == "Masculino", ]
base_masculino$como_considera_acessibilidade_atitudinal_ufsm <- factor(base_masculino$como_considera_acessibilidade_atitudinal_ufsm, levels = names(sort(table(base_masculino$como_considera_acessibilidade_atitudinal_ufsm), decreasing = TRUE)))

# Pra aparecer no grafico na ordem
ordem <- c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")

base_feminino$como_considera_acessibilidade_atitudinal_ufsm <- factor(base_feminino$como_considera_acessibilidade_atitudinal_ufsm, levels = ordem)
base_masculino$como_considera_acessibilidade_atitudinal_ufsm <- factor(base_masculino$como_considera_acessibilidade_atitudinal_ufsm, levels = ordem)
base1$como_considera_acessibilidade_atitudinal_ufsm <- factor(base1$como_considera_acessibilidade_atitudinal_ufsm, levels = ordem)

print(sprintf('Percentual de respostas bom ou regular para os homens é de %.1f %% e para mulheres é de %.1f %%', 
               sum(base_masculino$como_considera_acessibilidade_atitudinal_ufsm %in% c("Bom", "Ótimo")) / nrow(base_masculino) * 100, 
               sum(base_feminino$como_considera_acessibilidade_atitudinal_ufsm %in% c("Bom", "Ótimo")) / nrow(base_feminino) * 100))
```

Em relação acessibilidade atitudinal da UFSM (incentivo a percepções sem preconceitos, discriminações e estigmas), os homens novamnete se mostram mais satisfeitos do que as mulheres, em geral. Cerca de 43,8% das mulheres responderam bom ou ótimo e, para os homens, este percentual fica em 59,4%.  

```{r, echo=FALSE,warning=FALSE,warning=FALSE,fig.height=6, fig.width=10}
texto_size <- 2.5 #  tamanho do texto para as frequências
titulo_size <- 10 # tamanho do título dos gráficos

grafico <- ggplot(base1, aes(x = como_considera_acessibilidade_atitudinal_ufsm, fill = genero)) +
  geom_bar(position = "dodge") +
  labs(x = "Acessibilidade Atitudinal na UFSM", y = "Frequência absoluta", fill = "Gênero") +
  ggtitle("Avaliação da Acessibilidade Atitudinal por Gênero") +
  scale_fill_manual(values = c("Feminino" = "#445a14", "Masculino" = "#778c43")) +
  theme_minimal() +
  theme(plot.title = element_text(size = titulo_size))

grafico2 <- ggplot(base_feminino, aes(x = como_considera_acessibilidade_atitudinal_ufsm)) +
  geom_bar(fill = "#445a14", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Feminino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grafico3 <- ggplot(base_masculino, aes(x = como_considera_acessibilidade_atitudinal_ufsm)) +
  geom_bar(fill = "#778c43", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Masculino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grid.arrange(arrangeGrob(grafico2, grafico3, ncol = 1),
             grafico,
             layout_matrix = matrix(c(1, 2), ncol = 2, byrow = FALSE),
             widths = c(1, 2))
```



```{r, include=FALSE}
# comunicacional
table(base1$genero,base1$como_considera_acessibilidade_comunicacional_ufsm)
prop.table(table(base1$genero,base1$como_considera_acessibilidade_comunicacional_ufsm))*100

base_feminino <- base1[base1$genero == "Feminino", ]
base_feminino$como_considera_acessibilidade_comunicacional_ufsm <- factor(base_feminino$como_considera_acessibilidade_comunicacional_ufsm, levels = names(sort(table(base_feminino$como_considera_acessibilidade_comunicacional_ufsm), decreasing = TRUE)))

base_masculino <- base1[base1$genero == "Masculino", ]
base_masculino$como_considera_acessibilidade_comunicacional_ufsm <- factor(base_masculino$como_considera_acessibilidade_comunicacional_ufsm, levels = names(sort(table(base_masculino$como_considera_acessibilidade_comunicacional_ufsm), decreasing = TRUE)))

# Pra aparecer no grafico na ordem
ordem <- c("Ótimo", "Bom", "Regular", "Ruim", "Péssimo")

base_feminino$como_considera_acessibilidade_comunicacional_ufsm <- factor(base_feminino$como_considera_acessibilidade_comunicacional_ufsm, levels = ordem)
base_masculino$como_considera_acessibilidade_comunicacional_ufsm <- factor(base_masculino$como_considera_acessibilidade_comunicacional_ufsm, levels = ordem)
base1$como_considera_acessibilidade_comunicacional_ufsm <- factor(base1$como_considera_acessibilidade_comunicacional_ufsm, levels = ordem)

print(sprintf('Percentual de respostas bom ou regular para os homens é de %.1f %% e para mulheres é de %.1f %%',
               sum(base_masculino$como_considera_acessibilidade_comunicacional_ufsm %in% c("Bom", "Ótimo")) / nrow(base_masculino) * 100, 
               sum(base_feminino$como_considera_acessibilidade_comunicacional_ufsm %in% c("Bom", "Ótimo")) / nrow(base_feminino) * 100))
```

Em relação acessibilidade comunicacional da UFSM (oferecimento de recursos e atividades que promovam a independência no acesso a qualquer conteúdo. Isso inclui legendas, áudios, descrições, Libras, braile, etc), os homens novamnete se mostram mais satisfeitos do que as mulheres, em geral. Cerca de 28,1% das mulheres responderam bom ou ótimo e, para os homens, este percentual fica em 56,2%.  

```{r, echo=FALSE,warning=FALSE,warning=FALSE,fig.height=6, fig.width=10}
texto_size <- 2.5 #  tamanho do texto para as frequências
titulo_size <- 10 # tamanho do título dos gráficos

grafico <- ggplot(base1, aes(x = como_considera_acessibilidade_comunicacional_ufsm, fill = genero)) +
  geom_bar(position = "dodge") +
  labs(x = "Acessibilidade Comunicacional na UFSM", y = "Frequência absoluta", fill = "Gênero") +
  ggtitle("Avaliação da Acessibilidade Comunicacional por Gênero") +
  scale_fill_manual(values = c("Feminino" = "#445a14", "Masculino" = "#778c43")) +
  theme_minimal() +
  theme(plot.title = element_text(size = titulo_size))

grafico2 <- ggplot(base_feminino, aes(x = como_considera_acessibilidade_comunicacional_ufsm)) +
  geom_bar(fill = "#445a14", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Feminino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grafico3 <- ggplot(base_masculino, aes(x = como_considera_acessibilidade_comunicacional_ufsm)) +
  geom_bar(fill = "#778c43", position = "dodge") +
  geom_text(aes(label = ..count..), stat = "count", position = position_dodge(width = 0.9), vjust = -0.5, size = texto_size) +
  labs(x = NULL, y = NULL) +
  ggtitle("Gênero Masculino") +
  theme_minimal() +
  theme(axis.title = element_blank(), 
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5, size = titulo_size))

grid.arrange(arrangeGrob(grafico2, grafico3, ncol = 1),
             grafico,
             layout_matrix = matrix(c(1, 2), ncol = 2, byrow = FALSE),
             widths = c(1, 2))
```

Abaixo a tabela mostra a visão geral de como cada gênero enxerga as questões de acessibilidade. Para as mulheres ..........

```{r, echo=FALSE,warning=FALSE,warning=FALSE}
questoes <- c("como_considera_acessibilidade_comunicacional_ufsm",
              "como_considera_acessibilidade_atitudinal_ufsm",
              "como_considera_acessibilidade_instrumental_digital_ufsm",
              "como_considera_acessibilidade_arquitetonica_ufsm")
niveis <- c("otimo", "bom", "regular", "ruim", "pessimo")

acessibilidade_geral_fem <- bind_rows(lapply(questoes, function(questao) {
  prop_table <- table(base1[base1$genero == "Feminino", ][[questao]])
  prop.table(prop_table) * 100
}), .id = "Questão")

acessibilidade_geral_fem$Questão <- c('Comunicacional','Atitudinal','Instrumental/Digital','Arquitetônica')
acessibilidade_geral_fem <- acessibilidade_geral_fem %>%  rename('Ótimo (%)' = Ótimo, 'Bom (%)' = Bom, 'Regular (%)' = Regular, 'Ruim (%)' = Ruim,'Péssimo (%)' = Péssimo)

acessibilidade_geral_masc <- bind_rows(lapply(questoes, function(questao) {
  prop_table <- table(base1[base1$genero == "Masculino", ][[questao]])
  prop.table(prop_table) * 100
}), .id = "Questão")

acessibilidade_geral_masc$Questão <- c('Comunicacional','Atitudinal','Instrumental/Digital','Arquitetônica')
acessibilidade_geral_masc <- acessibilidade_geral_masc %>%  rename('Ótimo (%)' = Ótimo, 'Bom (%)' = Bom, 'Regular (%)' = Regular, 'Ruim (%)' = Ruim,'Péssimo (%)' = Péssimo)

knitr::kable(acessibilidade_geral_masc)
knitr::kable(acessibilidade_geral_fem)
```